### 소모 시간
- 1시간 10분

### 통과 여부
- 못 함.
- 다른 사람 정답보고 추가로 해서 풀었음.

### my solution
```sql
WITH NOVEMBER_CAR AS (
    SELECT CAR_ID
    FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
    WHERE STR_TO_DATE('2022-11-01', '%Y-%m-%d') BETWEEN START_DATE AND END_DATE
        OR STR_TO_DATE('2022-11-30', '%Y-%m-%d') BETWEEN START_DATE AND END_DATE
),
DISCOUNT_PRICE_APPLIED AS (
    SELECT c.CAR_ID AS CAR_ID, C.CAR_TYPE AS CAR_TYPE, FLOOR((DAILY_FEE - (DAILY_FEE * DISCOUNT_RATE * 0.01)) * 30) AS FEE
    FROM (
        SELECT *
        FROM CAR_RENTAL_COMPANY_CAR
        WHERE CAR_TYPE IN ('세단', 'SUV')
            AND CAR_ID NOT IN (SELECT CAR_ID FROM NOVEMBER_CAR)
        ) c
        JOIN (
            SELECT *
            FROM CAR_RENTAL_COMPANY_DISCOUNT_PLAN
            WHERE DURATION_TYPE = '30일 이상'
        ) p
        ON c.CAR_TYPE = p.CAR_TYPE
)

SELECT *
FROM DISCOUNT_PRICE_APPLIED
WHERE 500000 <= FEE AND FEE < 2000000
ORDER BY FEE DESC, CAR_TYPE, CAR_ID DESC
```

### other solution
```sql
SELECT C.CAR_ID AS CAR_ID, C.CAR_TYPE AS CAR_TYPE, FLOOR(C.DAILY_FEE * 30 * (1 - P.DISCOUNT_RATE/100)) AS FEE
FROM CAR_RENTAL_COMPANY_CAR C
INNER JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN P ON C.CAR_TYPE = P.CAR_TYPE AND P.DURATION_TYPE = '30일 이상'
LEFT OUTER JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY H ON C.CAR_ID = H.CAR_ID 
AND ('2022-11-01' BETWEEN H.START_DATE AND H.END_DATE OR '2022-11-30' BETWEEN H.START_DATE AND H.END_DATE)
WHERE C.CAR_TYPE IN ('세단','SUV') AND H.CAR_ID IS NULL
AND FLOOR(C.DAILY_FEE * 30 * (1 - P.DISCOUNT_RATE/100)) BETWEEN 500000 AND 1999999
ORDER BY FEE DESC, CAR_TYPE ASC, CAR_ID DESC
```
