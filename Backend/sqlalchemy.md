## Session Basics
- [공식 문서](https://docs.sqlalchemy.org/en/14/orm/session_basics.html) 내용 기록

### 세션은 뭘 하는가?
- 세션은 ORM 매핑 객체를 반환하고 수정할 SELECT 및 기타 쿼리가 생성되는 인터페이스를 제공한다.
- ORM 오브젝트 자체는 `Session` 내에서 즉, `identity map`이라고 불리는 구조체 내에서 관리된다.
- `identity map`은 각각의 오브젝트의 "고유한" 복사본을 관리하는 자료 구조이다. 여기서 "고유한"은 "특정 PK를 가지는 단 하나의 객체"를 의미한다.
- 쿼리가 실행되거나 다른 객체들이 영속화되면 세션과 연결된 엔진에서 커넥션 자원을 요청한 다음 해당 커넥션에서 트랜잭션을 설정한다.
- 이 트랜잭션은 세션이 트랜잭션을 커밋하거나 롤백하도록 지시할 때까지 유효하다.
- 세션에의해 유지되는 ORM 객체들은 파이썬 프로그램에서 속성이나 컬렉션이 변경될때마다, 세션에 의해 기록되는 변경 이벤트가 생성되도록 인스트러멘티드된다.
*instrumented: 특정 클래스의 기능 및 속성 집합을 보강하는 프로세스 (뭔소리야 😢)
- 데이터베이스가 쿼리될 때마다 또는 트랜잭션이 커밋되려고 할 때마다 세션은 먼저 메모리에 저장된 모든 펜딩 중인 변경 사항을 데이터베이스로 플러시한다. 이것은 unit of work 패턴의 단위로 알려져 있다.
- ORM 매핑 객체는 세션이 보유하고 있는 트랜잭션에 로컬인 데이터베이스 행에 대한 프록시 객체로 유지 관리된다.
- 객체의 상태를 데이터베이스에 실제로 있는 것과 일치하도록 유지하기 위해, 즉 동기화를 유지하기 위해 객체가 데이터베이스에 다시 액세스하도록 하는 다양한 이벤트가 있다.
- 세션에서 개체를 "분리"하고 계속 사용하는 것이 가능하지만 이 방법에는 주의 사항이 있다.
- 일반적으로 분리된 개체를 다시 작업하고 싶을 때 다른 `Session`과 다시 연결하여 데이터베이스 상태를 나타내는 정상적인 작업을 재개할 수 있도록 하기 위한 것이다.


## backref vs back_populates
- 객체간에 관계가 있을 때 사용하는 어트리뷰트.
- https://velog.io/@inourbubble2/SQLAlchemy%EC%9D%98-backref%EC%99%80-backpopulates%EC%9D%98-%EC%B0%A8%EC%9D%B4
